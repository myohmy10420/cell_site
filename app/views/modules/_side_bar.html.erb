<nav class="nav flex-column side-bar">
  <%= form_tag search_products_path, method: :post, class: "form-inline" do %>
    <input class="font font--08r" name="search_key" placeholder="快速查詢">
    <button class="btn btn-secondary" type="submit">
      <%= image_tag "icons/magnifying-glass.svg" %>
    </button>
  <% end %>

  <% Brand.all.order('sort ASC').each_with_index do |brand, index| %>
    <% if brand.has_products? %>
      <div class="accordion" id="accordion_<%= index %>">
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">
              <%= button_tag brand.name,
                type: 'button',
                style: 'font-weight: bold;',
                class: 'btn btn-link',
                data: {
                  toggle: 'collapse',
                  target: "#collapse_#{index}"
                } %>
            </h5>
          </div>

          <div id="collapse_<%= index %>"
               class="collapse collapse_<%= index %> <%= pre_expand_product_brand(brand, @product.try(:brand)) %>"
               data-parent="#accordion_<%= index %>">
            <div class="card-body">
              <% brand.products.order('name DESC').each do |product| %>
                <%= link_to product.name, product_path(product) %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
</nav>
